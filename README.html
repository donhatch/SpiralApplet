<!DOCTYPE html>
<html>
<!-- initial template from http://docs.mathjax.org/en/latest/start.html -->

<!--
    Notes:
        \; for thick space
        \: for medium space
        \, for thin space
        \! for negative thin space
    Q: can I set the default zoom trigger so I don't have to re-set it every time I reload the page?
-->
<head>
<title>There's No Single-Exit Lagoon</title>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            // make '$' delimit inline math
            inlineMath: [['$','$'], ['\\(','\\)']],
            // make \$ give a real dollar sign, even in non-math mode
            processEscapes: true
        },
        menuSettings: {
            // make it so that hovering over an equation zooms it
            // (right click on an equation to see how to alter this
            // within a session)
            // XXX this isn't working?
            zoom: 'hover'
        },
    });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>
<body>
\$300
When $a \ne 0$, there are two solutions to \(ax^2 + bx + c = 0\) and they are
$$x = {-b \pm \sqrt{b^2-4ac} \over 2a}.$$
<hr> <!--============================================================-->
Visualizing an infinite spiral
to try to prove the every-lagoon-has-at-most-two-good-exits conjecture.
<p>
Priscilla and Dudley take a walk counterclockwise
all the way around the primal and dual perimeter respectively,
in such a way that whenever Priscilla is moving along an edge of the primal,
Dudley is stopped at the corresponding vertex of the dual,
and when Dudley is moving along an edge of the dual,
Priscilla is stopped at the corresponding vertex of the primal.
Exactly one of Priscilla and Dudley are moving at any particular time.
<p>
Denote Priscilla's and Dudley's positions,
in rectangular and polar coordinates,
by the following, all continuous functions of time $t$:
    $$r_p,\theta_p, x_p, y_p$$
    $$r_d,\theta_d, x_d, y_d$$
<p>
    $$x_p = r_p \cos(\theta_p)  y_p = r_p \sin(\theta_p)$$
    $$x_d = r_d \cos(\theta_d)  y_d = r_d \sin(\theta_d)$$
<p>
Priscilla's and Dudley's paces are such that the one who's moving
always does so at unit rotation speed around the origin
while the other stays still.
So their positions are continuous piecewise differentiable functions of time,
with 
    $$(d \theta_p + d \theta_d) / dt = 1 \;  \text{wherever both are differentiable.}$$
<p>
Since the combined rotational speed is 1 and the combined rotational distance is
$4 \pi$,
it will take
$4 \pi$
units of time for Priscilla and Dudley
to complete one revolution and arrive back at their starting configuration;
if we fix Priscilla's starting point
$ \langle x_p,y_p \rangle (t=0)$
in the interior (not endpoint) of some primal side, this forces Dudley
to start at the dual vertex
$ \langle x_d,y_d \rangle (t=0)$
corresponding to that initial primal edge,
and the entire walk is thus determined.
They will arrive back at
$ \langle x_p,y_p\rangle,\langle x_d,y_d\rangle $ at time
$t = 4 \pi$.
<p>
Priscilla and Dudley's walk is defined (modulo the choice of starting point)
no matter what the polygon.
Let's apply it to the case of interest: a polygon
with only one good lagoon exit.
(We'll end up with a contradiction,
showing that, in fact, no single-exit single-polygon lagoon exists.)
<p>
Since the primal polygon is bounded by straight lines,
points on the boundary at local maximum and local minimum distance
from the polygon's cc are isolated,
and they alternate, with exactly the same number of local maxima
as local minima.
Furthermore by assumption there's exactly one local maximum
(at some farthest vertex);
therefore there's exactly one local minumum
(somewhere along the nearest side, *not* at a vertex),
which is therefore the unique global minimum.
We'll work in a coordinate system such that the cc
is at the origin
$\langle 0,0 \rangle$,
and the nearest point on the perimeter
is one unit below it, at
$\langle 0,-1\rangle$.
For the dual (at unrelated scale),
place the central vertex at the origin.
Then the dual edge corresponding to the primal edge closest to the origin
in primal space starts at the origin in dual space
and lies along the
$-y$
axis;
choose a scale so that it ends at
$\langle 0,-1\rangle$.
Having chosen the position and scale of the dual,
the entire dual diagram (triangle complex) is thus determined.
It consists of
$n$
triangles, each having one vertex at the origin.
<p>
We'll number the primal features in CCW order:
primal edges have even indices and primal vertices have odd indices:
    $$e_0 = the bottom horizontal edge passing through 0,-1$$
    $$v_1 = right endpoint of e_0$$
    $$e_2 = next edge CCW$$
    $$v_3 = next vertex CCW$$
    $$...$$
    $$e_{2 n - 2} = edge CW from e_0$$
    $$v_{2 n - 1} = left endpoint of e_0$$
<p>
Let
$m$
be the (odd) index of the vertex
that is the global maximum distance from the origin
of the entire primal polygon perimeter.
So
$v_m$
is the only good exit,
and distance-from=origin is strictly increasing
from
$\langle 0,-1\rangle$
around CCW to v_m,
and then strictly decreasing from v_m
back around CCW to
$\langle 0,-1\rangle$.
<p>
Consider the directions of the "quill" emanating
from each vertex of this primal polygon.
Since
$v_m$
is the only good exit,
every quill *except* the one at
$v_m$
points more towards the origin than away from it
(more precisely, the quill
$i$'s direction's dot product with
$v_i$ is
$\lt 0$), so it can't point directly out from the origin,
it must lean
$\gt 90$
degrees from that, CW or CCW.
For
$v_i$
with
$i \lt m$,
distance from origin to perimeter is increasing,
so the quill at
$v_i$
can't lean CCW
(or it would point into the polygon's interior)
so it must lean at least
$90^{\circ}$
CW from straight out.
Similarly for
$v_i$
with
$i>m$,
the quill at
$v_i$
must lean at least
$90^{\circ}$
CCW from straight out.
<p>
There is no apparent contradiction in anything described so far;
some plausible examples are shown in Figures 1(a-e).
<pre>
    Figure 1(a): 212
                         |  
                         *v5
                        / \
                     e6/   \e4
                      /     \
                   v7*       *v3
                    /|       |\
                     |e8   e2| 
                     |       |  
                   v9*---+---*v1
                     |   e0  |
        (XXX Need to tweak it a bit from this to give quills slop)

    Figure 1(b): 112
                    \
                     *v5
                     | \_
                     |   \e4
                     |     \_
                   e6|       *v3
                     |       | \
                     |       |  
                     |       |
                     |       |e2
                     |       |
                     |       |
                     |       |
                   v7*---+---*v1
                     |   e0  |
        (XXX Need to tweak it a bit from this to give quills slop)
        or maybe:
                    \
                     |
                     *v5
                     |\
                     | \
                     |  \
                     |   \e4
                     |    \
                     |     \
                     |      \
                   e6|       *v3
                     |       |  \
                     |       |e2
                     |       |
                   v7*---+---*v1
                     |   e0  |

    Figure 1(c): 013


                         __/
                      __/
                   __*v5
                __/   \
           e6__/       \
          __/           \
                         \e4
                          \
                           \
                            \
                             *v3
                             | \
            __/              |e2
         __/                 |
      v7*---- ... -------+---*v1
 ___/                    e0  |
/

    Figure 1(d): mild spiral

    Figure 1(e): steep spiral
</pre>
These examples satisfy all the properties
of a single-exit single-polygon lagoon with the cc at the origin,
*except* that when we actually compute the cc,
we'll find it is not at the origin.
We now show that every attempt at a single-exit single-polygon lagoon
is doomed in this way--
that is, given any candidate primal polygon
and a point in its interior such that there is only one good exit
with respect to that point,
that point is *not* the cc of the lagoon.
<p>
So, assume we are given such a candidate primal polygon,
and a point in its interior such that there is only one good exit
with respect to that point.
Choose a coordinate system that places that point at the origin,
with the polygon rotated so that
$v_m$
(the "apex")
has highest y coordinate,
and
$\text{slope}(e_{m-1}) = -\text{slope}(e_{m+1})$.
So
$v_{m-2}$
is to the lower-left of
$v_m$
and
$v_{m+2}$
is to the lower-right of
$v_m$.
$e_0$
will always be the single edge closest to the origin (though
it need not be horizontal any more).
Figure 2(a-e) shows the same polygons as Figure 1(a-e),
rotated in this way.
<p>
We will now show that, in this chosen coordinate system,
the cc's y coordinate is strictly positive,
and so the origin is not the cc.
<p>
Let
$l$
be the lowest-numbered (most CW) index such that
$v_{l+2}$'s
$x$
coord
is
$\leq$
that of
$v_l$'s
(i.e. such that
e_{l+1}
emerges north or northwest out of
$v_l$).
Let
$r$
be the highest-numbered (most CCW) index such that
$v_{r-1}$'s
$x$
coord is
$\ge$
that of
$v_r$'s.
<p>
Since
$e_{l+1}$
emerges north or northwest from
$v_l$
and the quill at
$v_l$
leans CW by more than
$90^{\circ}$
from outward,
it must be that
$v_l$
has positive
$y$
coord
(otherwise the angle formed by the quill and
$e_{l+1}$
would be greater than
$180^{\circ}$,
which is illegal).
<span id="youarehere"/>
Similarly
$v_r$
has positive
$y$
coord,
and similarly all vertices between them,
$v_{l+2}, ..., v_{r-2}$
have positive
$y$
coord as well.
<p>
The crux of this proof is to show that the cc of all the vertices
$v_1..v_r$
has positive
$y$
coord, or equivalently,
that their moment (cc times total curvature) has positive
$y$
coord.
<p>
Then by symmetric reasoning,
the cc (or equivalently the moment) of
$v_l..v{2n-1}$
also has positive
$y$
coord;
furthermore as previously mentioned, each of the vertices
$v_{l+2}..v_{r-2}$
has positive
$y$
coord as well, so:
\begin{align}
    \text{moment}(v_1..v_{2n-1}) = & \text{moment}(v_1..v_l) \\
                                 + & \text{moment}(v_{l+2}..v_{r-2}) \\
                                 + & \text{moment}(v_r..v_{2n-1})
\end{align}
being the sum of three quantities each with positive y coord,
has positive y coord as well, and we are done.
<p>
So, we just need to show that the moment
of the initial vertices
v_1..v_l
has positive
y
coord.
<p>
We let Priscilla and Dudley compute the moment
by doing their walk around the primal and dual.
Priscilla starts anywhere in the interior of edge e_0
and ends anywhere in the interior of edge
e_{l+1}.
Dudley starts and ends at the respective dual vertices.
(XXX maybe call them $v'_0$ and $v'_{l+1}$? yes I think so)
<p>
We consider an "event"
to be a moment during the walk
in which one or more of the following happen:
<ul>
    <li> Priscilla stops moving and Dudley starts moving
         (the first event is of this type)
    <li> Dudley stops moving and Priscilla starts moving
    <li> Dudley crosses the $x$ axis,
         from negative to positive $y$ coordinate
         (this will be a separate event
         iff no dual vertex lies on the $x$ axis).
<ul>
<p>
The accumulated moment vector starts as zero;
at each event at which Dudley has been moving,
Dudley computes the area of the triangle formed by
his previous event position, his current position, and the origin,
and adds
    $$(Dudley's triangle area)*(Priscilla's position)$$
to the moment vector being accumulated.
<p>
We'll prove the desired result
(that the moment of
$v_1..v_l$
has positive
y
coord)
by inductively proving that a stronger statement holds
at each moment in Priscilla and Dudley's walk.
The desired result follows from the following Lemma's
statement (B) at the end of the walk.
XXX why? need to be more specific
<p>
Lemma:
During Priscilla and Dudley walk around the primal (from e_0 to e_{l+1}) and dual
as described above, at all times strictly after the first event:
\begin{align}
    &amp; (A) 0 &amp; < r_m &amp;&lt; r_p r_d^2 \sin(\theta_p-\theta_d) \cos(\theta_p-\theta_d) / 2 \\
    &amp; (B) \theta_d &amp;&lt;  \theta_m \\
    &amp; (C)          &amp;&lt; = \theta_p$$ \\
    &amp; (D)          &amp;&lt;  \theta_d+\pi/2. \\
\end{align}
<p>
Proof:
<p>
Note first of all the significance of the "after the first event"
in the Lemma statement.
This clause is necessary because,
up to and including the first event
(Priscilla stopping at
v_1
and Dudley starting moving),
r_m = |m| = 0,
and so (A) doesn't hold
(and (B),(C) don't even make sense since
\theta_m
isn't even defined).
<p>
(XXX this can be moved out of the lemma and proof, it can just be an observation earlier)
In any of Priscilla and Dudley's walks,
convexity of the primal polygon and the fact that it contains the origin
in its interior implies that, at all times,
Priscilla's position vector and her outward normal (right) vector
are strictly within
$90^{\circ}$
of each other.
In other words (since Priscilla's outward normal vector
is in the direction of Dudley's position vector, by definition)
    $$(1)    \theta_d \lt \theta_p \lt \theta_d+\pi/2,$$
so (D) is always satisfied during any walk on any primal polygon
containing the origin.
We prove the other parts, (A),(B),(C) by induction on the number of events
(as defined earlier) encountered so far.
<p>
The base case will be the case when
the number of *previous* events encountered is
1.
(This includes all times strictly after the first event
up to and including the second event.)
That is, Priscilla has stopped moving at
v_1
(that was the first event)
and Dudley has been moving along the corresponding edge
e'_1
in the dual diagram.
At this time,
    $$(2)    m = (Dudley's triangle area so far)*(Priscilla's position)$$
which is a nonzero scalar times the nonzero vector
p=v_1,
so r_m = |m| > 0
(so the first part of (A) is satisfied, and \theta_m is well-defined),
and \theta_m = \theta_p.
Combining this with (1), we have:
    $$\theta_d < \theta_m = \theta_p < \theta_d+\pi/2$$
and so (B),(C),(D) are satisfied.
We still have to prove that the second part of (A) holds in the base case.
<p>
For this base case,
we temporarily rotate the entire picture
so that Priscilla's position
p
is on the
+y
axis,
and so Dudley is traveling upwards along the now-vertical dual edge
e'_1,
as shown in Figure 3.
Note that this temporary rotation of the picture
does not change the statement of (A) that we are trying to prove,
since all of the quantities
r_m, r_p, r_d, \theta_p-\theta_d
are invariant under this rotation
(even though
\theta_p
and
\theta_d
have changed-- specifically,
\theta_p
is now
\pi/2).
(XXX Alternatively, could denote these rotated coords by carat'ing them)
<pre>
      Priscilla
       p=v_1*
            :       *v'_2
            :       |
            :     / |
            :       |e'_1
            :    /  |
            :       |  Dudley    ^
            :   /   *d=<x_d,y_d> |
            :      /|            |
            :  /  / | 
            :    /  |  
            : / /  _*v'_0
            :  / _/ :
            ://_/   :
            ://     :
           0*.......* <x_d,0>

        Fig. 3: base case in temporarily rotated coord system
</pre>
We can get an upper bound on the area of Dudley's triangle so far,
as follows:
    Dudley's triangle area so far
\begin{align}
        &amp;= \text{areaTri}(0,v'_0,d) \\
        &amp;&lt; \text{areaTri}(0,&lt;x_d,0&gt;,d) \text{since the former triangle is included in the latter, since v'_0 has y coord &gt; 0 (XXX prove this!)} \\
        &amp;= x_d y_d / 2 \\
        &amp;= (r_d \cos(\theta_d)) (r_d \sin(\theta_d)) / 2\\
        &amp;= (r_d \sin(\pi/2-\theta_d)) (r_d \cos(\pi/2-\theta_d)) / 2\\
(3)     &amp;= r_d^2 \sin(\pi/2-\theta_d) \cos(\pi/2-\theta_d) / 2
\end{align}
<p>
Recalling (2),
\begin{align}
     m &amp;=&amp; (\text{Dudley's triangle area so far})&amp;*&amp;(\text{Priscilla's position}) \\
       &amp;=&amp; (\text{Dudley's triangle area so far})&amp;*&amp;p
\end{align}
Taking magnitude of both sides,
\begin{align}
   r_m &amp;=&amp; r_p * (\text{Dudley's triangle area so far}) \\
       &amp;&lt;&amp; r_p * (r_d^2 \sin(\pi/2-\theta_d) \cos(\pi/2-\theta_d) / 2 )  by (3) \\
       &amp;=&amp; r_p r_d^2 \sin(\pi/2-\theta_d) \cos(\pi/2-\theta_d) / 2
\end{align}
and so we've shown the second part of (A),
completing the proof of the base case.
<p>
For the inductive hypothesis,
assume the statement of the lemma was true
at the (strictly) previous event;
we will show it's true now
(this argument will hold not only when "now" is the following event,
which completes the finite induction,
but also when "now" is between events,
which is needed since the statement of the Lemma is not limited
to just events, it also holds at all times between events.)
Using underbars to denote the respective values
at the previous event (XXX actually in the case of the first event, slightly after it) (XXX actually this is silly, why don't we just make the lemma talk about only events
$\ge 2$, I think that will simplify things?)

$$\begin{align}
    \underline{p} &amp; = \langle \underline{r_p} \cos \underline{\theta_p}, \; \underline{r_p} \sin \underline{\theta_p} \rangle \\
    \underline{d} &amp; = \langle \underline{r_d} \cos \underline{\theta_d}, \; \underline{r_d} \sin \underline{\theta_d} \rangle \\
    \underline{m} &amp; = \langle \underline{r_m} \cos \underline{\theta_m}, \; \underline{r_m} \sin \underline{\theta_m} \rangle
\end{align}$$

The inductive hypothesis is:
\begin{alignat*}{3}
    & (\underline{A}) & & 0               & & \lt \underline{r_m} \lt \underline{r_p} \underline{r_d}^2 \sin(\underline{\theta_p}-\underline{\theta_d}) \cos(\underline{\theta_p}-\underline{\theta_d}) / 2 \\
    & (\underline{B}) & & \underline{\theta_d} & & \lt  \underline{\theta_m} \\
    & (\underline{C}) & &                 & & \leq \underline{\theta_p} \\
    & (\underline{D}) & &                 & & \lt \underline{\theta_d}+\pi/2.
\end{alignat*}
<p>
There are two cases.
<p>
Case 1: In the time since the previous event,
Priscilla has moved (in a straight line) and Dudley has stayed still.
<p>
This time we temporarily rotate the picture so that Dudley's position
is on the
+x
axis,
and so Priscilla has travelled upwards along a now-vertical primal edge,
as shown in Figure 4.
As in the base case, this temporary rotation of the picture
does not change the truth or falsity of the lemma
(even though
\theta_p
and
\theta_d
have changed-- specifically,
\theta_d
is now
0).
<pre>
            (The following scale looked nice on paper:)
            ....*
            ....|
            ....|
            ....*
            .....
            .....
            *....
                    *p=<x_p,y_p>
                    |
                  . |
                    | ^
                 .  | |
                    | | Priscilla walks from $\underline{p}$ to p
                .   | | (perpendicular to Dudley's stationary position)
                    | |
               .    | 
                    |  
              .     *\underline{p}=<\underline{x_p},\underline{y_p}>
                  .  
             .  .    
              .             Dudley
           0*----------------*d=\underline{d}

        Fig. 4: Inductive step, Case 1: Priscilla has moved
</pre>
In this case we have the following relationships between the previous event's values
and the current values.
Dudley didn't move:
    $$(5)    r_d = \underline{r_d}$$
    $$(6)    \theta_d = \underline{\theta_d} = 0$$
nor did the moment (since the moment only changes when Dudley moves):
    $$(7)    r_m = \underline{r_m}$$
    $$(8)    \theta_m = \underline{\theta_m} \text{(assuming $\underline{\theta_m}$ is well-defined-- which it is, by inductive hypothesis)}$$
Priscilla's angle increased, but stayed less than $\pi/2$:
    $$(9)    0 < \underline{\theta_p} < \theta_p < \pi/2       \text{(XXX do we need to argue that $\underline{p}$ is strictly positive first?}$$
   $$(10)    0 < \sin(\underline{\theta_p}) < \sin(\theta_p) < 1    \text{(follows from (9) since $\sin$ is increasing in this range)}$$
   $$(11)    0 < \cos(\theta_p) < \cos(\underline{\theta_p}) < 1    \text{(follows from (9) since $\cos$ is decreasing in this range)}$$
<p>
Expressing the horizontal distance from the origin to the edge Priscilla is on
in two ways:
\begin{align}
         \underline{r_p} \cos(\underline{\theta_p}) & = \underline{x_p} \\
                          & = x_p \\
                          & = r_p \cos(\theta_p) \\
    (12) \underline{r_p} \cos(\underline{\theta_p}) & = r_p \cos(\theta_p)
\end{align}
<p>
Proving (B) is easy:
\begin{align}
    \theta_d & = \underline{\theta_d}  \text{by (6)} \\
             & < \underline{\theta_m}  \text{by} (\underline{B}) \\
             & = \theta_m    \text{by (8).}
\end{align}
Proving (C) is easy:
\begin{align}
    \theta_m & = \underline{\theta_m}  \;\; \text{by (8)} \\
             & \leq \underline{\theta_p}  \;\; \text{by} (\underline{C}) \\
             & < \theta_p  \;\; \text{by (9)}
\end{align}
And (D) is always satisfied (recall it's not part of the induction).
<p>
We must prove (A).
The first inequality of (A) is easily proved:
\begin{align}
    r_m & = \underline{r_m}  \;\; \text{by (7)} \\
        & > 0  \;\; \text{by} (\underline{A})
\end{align}
<p>
Proceeding now to prove the second inequality of (A):
\begin{align}
    r_m & = \underline{r_m}  \;\; \text{by (7)} \\
        & < \underline{r_p} \underline{r_d}^2 \sin(\underline{\theta_p}-\underline{\theta_d}) \cos(\underline{\theta_p}-\underline{\theta_d}) / 2  \;\; \text{by} (\underline{A}) \\

        & < \underline{r_p} \underline{r_d}^2 \sin(\underline{\theta_p}) \cos(\underline{\theta_p}) / 2  \;\; \text{since $\underline{\theta_d}=0$ in this temporarily rotated picture (XXX maybe use carats instead?)} \\
        & < \underline{r_p} r_d^2 \sin(\underline{\theta_p}) \cos(\underline{\theta_p}) / 2  \;\; \text{by (5)} \\
        & = (\underline{r_p} \cos(\underline{\theta_p})) r_d^2 \sin(\underline{\theta_p})/2   \;\; \text{(just rearranging terms)} \\
        & = (r_p \cos(\theta_p)) r_d^2 \sin(\underline{\theta_p})/2  \;\; \text{by (12)} \\
        & < (r_p \cos(\theta_p)) r_d^2 \sin(\theta_p)/2  \;\; \text{by (10), since all factors are positive (by (10) and (11))} \\
        & = r_p r_d^2 \sin(\theta_p) \cos(\theta_p) / 2   \;\; \text{(just rearranging terms)} \\
        & = r_p r_d^2 \sin(\theta_p-\theta_d) \cos(\theta_p-\theta_d) / 2  \;\; \text{since $\theta_d=0$ in this rotated picture} \\
\end{align}
and so the second inequality of (A) is proved,
completing Case 1 of the inductive step.
<p>
Case 2: In the time since the previous event,
Dudley has moved (in a straight line) and Priscilla has stayed still.
<p>
<red>TODO fill this in!</red>
<p>

<hr> <!--============================================================-->


<pre>
extra scratch stuff
Lemma:  Given a polygon as previously described,
for each odd i in {1,3,...l},
    XXX MAYBE, but different language
    (C) moment(v_1..v_i) dot (v_{i+2}-v_i) > 0
    (A) ||moment(v_1..v_i)|| < ||v_i|| {r_d}^2 \sin(\theta_p-\theta_d)     XXX how the fuck did r_d get in here?
    (B) d^perpdot dot moment{v_1..v_i} > 0                              XXX how the fuck did d get in here?  actually need to talk about constructing the dual I think?
</pre>



</body>
</html>

